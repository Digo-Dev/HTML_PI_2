<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Formulário de Solicitação de Serviço</title>
</head>
<body>
    <h2>Solicitação de Serviço</h2>
    <h3>Envie para a planilha de análise de dados a solicitação, preenchendo todos os itens e clicando em enviar</h3>

    <label>Solicitante:</label>
    <input type="text" id="solicitante" placeholder="Nome do solicitante" required><br><br>

    <label>Data:</label>
    <input type="date" id="data" required><br><br>

    <label>Serviço:</label>
    <select id="servico" required>
        <option value="tapa buraco">tapa buraco</option>
        <option value="hidrojato">hidrojato</option>
        <option value="cata treco/entulho">cata treco/entulho</option>
        <option value="iluminação pública">iluminação pública</option>
        <option value="reposição de tampas e grelhas das galerias de águas pluviais">reposição de tampas e grelhas das galerias de águas pluviais</option>
        <option value="roçagem e raspação">roçagem e raspação</option>
        <option value="nivelamento de piso sextavado">nivelamento de piso sextavado</option>
    </select><br><br>

    <label>Status:</label>
    <select id="status" required>
        <option value="Iniciada">Iniciada</option>
        <option value="Em andamento">Em andamento</option>
        <option value="Cancelada">Cancelada</option>
        <option value="Serviço realizado">Serviço realizado</option>
    </select><br><br>

    <label>Responsável:</label>
    <select id="responsavel" required>
        <option value="José">José</option>
        <option value="João">João</option>
        <option value="Apolonio">Apolonio</option>
        <option value="Manoel">Manoel</option>
        <option value="José Carlos">José Carlos</option>
    </select><br><br>

    <label>Bairro:</label>
    <select id="bairro" required>
        <option value="Gonzaguinha">Gonzaguinha</option>
        <option value="Beira Mar">Beira Mar</option>
        <option value="Boa Vista">Boa Vista</option>
        <option value="Gleba">Gleba</option>
        <option value="Quarentenário">Quarentenário</option>
        <option value="Parque das Bandeiras">Parque das Bandeiras</option>
        <option value="Humaitá">Humaitá</option>
    </select><br><br>

    <label>Observações (máx. 200 caracteres):</label>
    <textarea id="observacao" maxlength="200" placeholder="Digite observações aqui"></textarea><br><br>

    <button onclick="enviarDados()">Enviar</button>

    <script>
        function enviarDados() {
            const solicitante = document.getElementById("solicitante").value;
            const data = document.getElementById("data").value;
            const servico = document.getElementById("servico").value;
            const status = document.getElementById("status").value;
            const responsavel = document.getElementById("responsavel").value;
            const bairro = document.getElementById("bairro").value;
            const observacao = document.getElementById("observacao").value;

            const url = "https://script.google.com/macros/s/AKfycbzLC0IzROZg_DeBl22bKeuuBFl2cI6dJTjzscOSO9-uJs2IaN6WwuQD9XhrPuLQtX7UDw/exec";

            fetch(url, {
                method: "POST",
                mode: "no-cors",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ solicitante, data, servico, status, responsavel, bairro, observacao })
            })

            async function fetchData() {
    const response = await fetch("https://script.google.com/macros/s/AKfycbzLC0IzROZg_DeBl22bKeuuBFl2cI6dJTjzscOSO9-uJs2IaN6WwuQD9XhrPuLQtX7UDw/exec");
    const data = await response.json();
    return data;
}


            .then(response => {
                alert("Dados enviados com sucesso!");
            })
            .catch(error => {
                console.error("Erro ao enviar os dados:", error);
                alert("Erro ao enviar os dados. Tente novamente.");
            });
        }
    </script>
</body>
</html>
